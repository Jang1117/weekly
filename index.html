<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ì£¼ê°„ ì¼ì •í‘œ - ëª¨ë°”ì¼ ìµœì í™”</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: 'Segoe UI', AppleSDGothicNeo-Medium, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 10px;
            color: #333;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        h1 {
            text-align: center;
            font-size: 1.5rem;
            margin-bottom: 10px;
        }
        
        .instructions {
            text-align: center;
            color: #666;
            margin-bottom: 15px;
            font-size: 11px;
            word-break: keep-all;
            line-height: 1.4;
        }
        
        /* ê·¸ë¦¬ë“œ ì˜ì—­ ìµœì í™” */
        .schedule-wrapper {
            overflow-x: auto;
            overflow-y: auto;
            max-height: 65vh;
            border: 1px solid #ddd;
            border-radius: 8px;
            /* ëª¨ë°”ì¼ ë“œë˜ê·¸ ì‹œ ìŠ¤í¬ë¡¤ ë°©í•´ ê¸ˆì§€ */
            touch-action: pan-x pan-y;
        }
        
        .schedule-grid {
            display: grid;
            /* ì‹œê°„ì—´ ë„ˆë¹„ ì¶•ì†Œ (70px -> 50px) */
            grid-template-columns: 50px repeat(7, 1fr);
            min-width: 700px; /* ëª¨ë°”ì¼ì—ì„œ 7ì¼ì´ ë³´ì¼ ì •ë„ì˜ ìµœì†Œ ë„ˆë¹„ */
            position: relative;
        }
        
        .header {
            background: #667eea;
            color: white;
            padding: 10px 5px;
            text-align: center;
            font-weight: bold;
            font-size: 13px;
            position: sticky;
            top: 0;
            z-index: 10;
            border: 1px solid #5568d3;
        }
        
        .header-date {
            font-size: 10px;
            display: block;
            margin-top: 2px;
            opacity: 0.8;
        }
        
        .time-slot {
            background: #f1f3f5;
            padding: 5px 2px;
            text-align: center;
            font-size: 10px;
            font-weight: 600;
            color: #666;
            border: 0.5px solid #e0e0e0;
            position: sticky;
            left: 0;
            z-index: 5;
            display: flex;
            align-items: flex-start;
            justify-content: center;
        }
        
        .schedule-cell {
            background: white;
            border: 0.5px solid #eee;
            min-height: 45px;
            position: relative;
            cursor: crosshair;
        }

        /* í„°ì¹˜ ì¡°ì‘ ì‹œ ì…€ ê°•ì¡° */
        .schedule-cell.selecting { background: #d4e5ff !important; }
        .schedule-cell.drop-target { background: #fff3cd !important; border: 2px dashed #ffc107; }

        /* ì¼ì • ìŠ¤íƒ€ì¼ */
        .event {
            position: absolute;
            left: 1px;
            right: 1px;
            color: white;
            padding: 4px;
            border-radius: 4px;
            font-size: 11px;
            cursor: move;
            z-index: 3;
            box-shadow: 0 2px 4px rgba(0,0,0,0.15);
            overflow: hidden;
            line-height: 1.2;
        }
        
        .event-title { font-weight: bold; margin-bottom: 2px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .event-time { font-size: 9px; opacity: 0.9; }

        .event.ahyun { background: linear-gradient(135deg, #f48fb1, #e91e63); }
        .event.haseung { background: linear-gradient(135deg, #64b5f6, #2196f3); }
        .event.common { background: linear-gradient(135deg, #81c784, #4caf50); }

        .event-delete, .event-edit {
            position: absolute;
            top: 1px;
            background: rgba(255,255,255,0.3);
            border: none;
            color: white;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
        }
        .event-delete { right: 1px; }
        .event-edit { right: 21px; }

        .event-resize-handle {
            position: absolute;
            bottom: 0; left: 0; right: 0; height: 10px;
            cursor: ns-resize;
        }

        /* í•˜ë‹¨ ì»¨íŠ¸ë¡¤ ì˜ì—­ */
        .controls {
            margin-top: 15px;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
        }
        
        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 5px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: bold;
            cursor: pointer;
            transition: 0.2s;
        }
        
        button:active { transform: scale(0.95); background: #5568d3; }

        /* ëª¨ë‹¬ ìµœì í™” */
        .modal {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        .modal.active { display: flex; }
        .modal-content {
            background: white;
            padding: 20px;
            border-radius: 15px;
            width: 100%;
            max-width: 350px;
        }

        .user-selector { display: flex; gap: 5px; margin-bottom: 15px; }
        .user-button { flex: 1; padding: 10px 5px; border: 2px solid #ddd; background: #fff; font-size: 12px; border-radius: 6px; }
        .user-button.active { border-color: #667eea; background: #f0f4ff; }

        .form-group { margin-bottom: 12px; }
        .form-group label { display: block; font-size: 12px; margin-bottom: 4px; }
        .form-group input, .form-group textarea { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px; }

        /* ì¸ì‡„ ë° ë¡œë”© */
        .loading-overlay {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255,255,255,0.9); z-index: 3000;
            flex-direction: column; justify-content: center; align-items: center;
        }
        .loading-overlay.active { display: flex; }
        .loading-spinner { width: 40px; height: 40px; border: 4px solid #f3f3f3; border-top: 4px solid #667eea; border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { 100% { transform: rotate(360deg); } }

        /* ëª¨ë°”ì¼ ëŒ€ì‘ ì¸ì‡„ ì˜ì—­ ìˆ¨ê¹€ */
        #printContainer { display: none; }

        @media print {
            .container, .controls, .modal { display: none !important; }
            #printContainer { display: block !important; width: 100%; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“… ì£¼ê°„ ì¼ì •í‘œ</h1>
        <div class="instructions">
            ë“œë˜ê·¸: ì¼ì •ìƒì„±/ì´ë™ | Ctrl+í´ë¦­: ë³µì‚¬&ë¶™ì—¬ë„£ê¸°<br>í•˜ë‹¨ ë“œë˜ê·¸: í¬ê¸°ì¡°ì ˆ
        </div>
        
        <div class="schedule-wrapper" id="scheduleWrapper">
            <div class="schedule-grid" id="scheduleGrid">
                <div class="header">ì‹œê°„</div>
                <div class="header" data-day="0">ì›”<span class="header-date" id="date-0"></span></div>
                <div class="header" data-day="1">í™”<span class="header-date" id="date-1"></span></div>
                <div class="header" data-day="2">ìˆ˜<span class="header-date" id="date-2"></span></div>
                <div class="header" data-day="3">ëª©<span class="header-date" id="date-3"></span></div>
                <div class="header" data-day="4">ê¸ˆ<span class="header-date" id="date-4"></span></div>
                <div class="header" data-day="5">í† <span class="header-date" id="date-5"></span></div>
                <div class="header" data-day="6">ì¼<span class="header-date" id="date-6"></span></div>
            </div>
        </div>
        
        <div class="controls">
            <button onclick="openDateModal()">ğŸ“… ë‚ ì§œ</button>
            <button onclick="openPrintModal()">ğŸ–¨ï¸ ì¸ì‡„</button>
            <button onclick="clearAllEvents()">ğŸ§¹ ì´ˆê¸°í™”</button>
            <button onclick="exportSchedule()">ğŸ“¤ ë‚´ë³´ë‚´ê¸°</button>
            <button onclick="importSchedule()">ğŸ“¥ ê°€ì ¸ì˜¤ê¸°</button>
        </div>
    </div>

    <div class="modal" id="eventModal">
        <div class="modal-content">
            <h2 id="modalTitle" style="font-size:1.2rem; margin-bottom:15px;">ì¼ì • ì„¤ì •</h2>
            <div class="user-selector">
                <button type="button" class="user-button ahyun active" onclick="selectUser('ahyun')">ğŸ‘©ì•„í˜„</button>
                <button type="button" class="user-button haseung" onclick="selectUser('haseung')">ğŸ‘¨í•˜ìŠ¹</button>
                <button type="button" class="user-button common" onclick="selectUser('common')">ğŸ‘¥ê³µí†µ</button>
            </div>
            <div class="form-group">
                <label>ì¼ì • ì œëª©</label>
                <input type="text" id="eventTitle" placeholder="ì œëª©">
            </div>
            <div class="form-group">
                <label>ì„¤ëª… (ì„ íƒ)</label>
                <textarea id="eventDescription" placeholder="ì„¤ëª…"></textarea>
            </div>
            <div style="display:flex; gap:10px;">
                <button class="user-button" onclick="closeModal()" style="background:#eee;">ì·¨ì†Œ</button>
                <button class="user-button" onclick="saveEvent()" style="background:#667eea; color:white; border:none;">ì €ì¥</button>
            </div>
        </div>
    </div>

    <div class="modal" id="dateModal">
        <div class="modal-content">
            <h2 style="font-size:1.2rem; margin-bottom:15px;">ğŸ“… ë‚ ì§œ ì„¤ì •</h2>
            <div class="form-group">
                <label>ê¸°ì¤€ ì›”ìš”ì¼ ë‚ ì§œ</label>
                <input type="date" id="mondayDate">
            </div>
            <div style="display:flex; gap:10px; margin-top:15px;">
                <button class="user-button" onclick="closeDateModal()" style="background:#eee;">ì·¨ì†Œ</button>
                <button class="user-button" onclick="saveDates()" style="background:#667eea; color:white; border:none;">ì ìš©</button>
            </div>
        </div>
    </div>

    <div class="modal" id="printModal">
        <div class="modal-content">
            <h2 style="font-size:1.2rem; margin-bottom:10px;">ğŸ–¨ï¸ ì¸ì‡„ ë²”ìœ„</h2>
            <div style="display:flex; align-items:center; gap:5px; margin-bottom:15px;">
                <select id="printStartTime" style="padding:5px; flex:1;"></select>
                <span>~</span>
                <select id="printEndTime" style="padding:5px; flex:1;"></select>
            </div>
            <div style="display:flex; gap:5px; margin-bottom:15px;">
                <button id="p-portrait" class="user-button active" onclick="selectOrientation('portrait')">ğŸ“„ ì„¸ë¡œ</button>
                <button id="p-landscape" class="user-button" onclick="selectOrientation('landscape')">ğŸ“ƒ ê°€ë¡œ</button>
            </div>
            <div style="display:flex; gap:10px;">
                <button class="user-button" onclick="closePrintModal()" style="background:#eee;">ì·¨ì†Œ</button>
                <button class="user-button" onclick="executePrint()" style="background:#667eea; color:white; border:none;">ì¸ì‡„í•˜ê¸°</button>
            </div>
        </div>
    </div>

    <div id="printContainer"></div>
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
        <div style="margin-top:10px">ì¤€ë¹„ ì¤‘...</div>
    </div>

    <script>
        // ê¸°ì´ˆ ë°ì´í„° ìƒì„±
        const times = [];
        for (let h = 9; h <= 21; h++) {
            times.push(`${String(h).padStart(2, '0')}:00`);
            if (h < 21) times.push(`${String(h).padStart(2, '0')}:30`);
        }
        
        const grid = document.getElementById('scheduleGrid');
        times.forEach((time, timeIndex) => {
            const ts = document.createElement('div');
            ts.className = 'time-slot'; ts.textContent = time; ts.dataset.row = timeIndex;
            grid.appendChild(ts);
            
            for(let d=0; d<7; d++) {
                const cell = document.createElement('div');
                cell.className = 'schedule-cell';
                cell.dataset.day = d; cell.dataset.time = timeIndex; cell.dataset.row = timeIndex;
                grid.appendChild(cell);
            }
        });

        // ìƒíƒœ ê´€ë¦¬
        let events = JSON.parse(localStorage.getItem('weeklyEvents') || '[]');
        let isDragging = false, dragStart = null, dragEnd = null, currentEvent = null;
        let isResizing = false, resizingEvent = null, isDraggingEvent = false, draggedEventIndex = null;
        let selectedUser = 'ahyun', selectedOrientation = 'portrait';
        let weekDates = JSON.parse(localStorage.getItem('weekDates') || 'null');
        let copiedEvent = null;

        // --- í„°ì¹˜ ë° ë§ˆìš°ìŠ¤ ê³µí†µ ì¢Œí‘œ ì¶”ì¶œ í•¨ìˆ˜ ---
        function getTargetCell(e) {
            const touch = e.touches ? e.touches[0] : e;
            const el = document.elementFromPoint(touch.clientX, touch.clientY);
            return el ? el.closest('.schedule-cell') : null;
        }

        // --- ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ í†µí•© (ëª¨ë°”ì¼/ë°ìŠ¤í¬íƒ‘) ---
        function handleStart(e) {
            const cell = getTargetCell(e);
            if (cell && !isResizing && !isDraggingEvent) {
                // Ctrl+í´ë¦­ ë¶™ì—¬ë„£ê¸° ê¸°ëŠ¥ (ëª¨ë°”ì¼ì€ ê³ ë ¤ ì•ˆí•¨)
                if ((e.ctrlKey || e.metaKey) && copiedEvent) {
                    pasteEvent(cell); return;
                }
                isDragging = true;
                dragStart = { day: parseInt(cell.dataset.day), time: parseInt(cell.dataset.time) };
                dragEnd = {...dragStart};
                cell.classList.add('selecting');
                if (e.touches) e.preventDefault(); // ëª¨ë°”ì¼ ìŠ¤í¬ë¡¤ ë°©ì§€
            }
        }

        function handleMove(e) {
            if (isDragging) {
                const cell = getTargetCell(e);
                if (cell && parseInt(cell.dataset.day) === dragStart.day) {
                    dragEnd = { day: parseInt(cell.dataset.day), time: parseInt(cell.dataset.time) };
                    updateSelection();
                }
                e.preventDefault();
            } else if (isResizing) {
                const cell = getTargetCell(e);
                if (cell && parseInt(cell.dataset.day) === events[resizingEvent].day) {
                    const newTime = parseInt(cell.dataset.time);
                    if (newTime > events[resizingEvent].startTime) {
                        events[resizingEvent].endTime = newTime;
                        renderEvents();
                    }
                }
                e.preventDefault();
            } else if (isDraggingEvent) {
                const cell = getTargetCell(e);
                document.querySelectorAll('.drop-target').forEach(c => c.classList.remove('drop-target'));
                if (cell) cell.classList.add('drop-target');
                e.preventDefault();
            }
        }

        function handleEnd(e) {
            if (isDragging) {
                isDragging = false;
                document.querySelectorAll('.selecting').forEach(c => c.classList.remove('selecting'));
                if (dragStart && dragEnd) openModal(dragStart, dragEnd);
            }
            if (isResizing) { isResizing = false; saveToLocalStorage(); }
            if (isDraggingEvent) {
                const cell = getTargetCell(e);
                if (cell) {
                    const ev = events[draggedEventIndex];
                    const dur = ev.endTime - ev.startTime;
                    ev.day = parseInt(cell.dataset.day);
                    ev.startTime = parseInt(cell.dataset.time);
                    ev.endTime = ev.startTime + dur;
                    saveToLocalStorage();
                    renderEvents();
                }
                isDraggingEvent = false;
                document.querySelectorAll('.drop-target').forEach(c => c.classList.remove('drop-target'));
            }
        }

        grid.addEventListener('mousedown', handleStart);
        window.addEventListener('mousemove', handleMove);
        window.addEventListener('mouseup', handleEnd);

        grid.addEventListener('touchstart', handleStart, {passive: false});
        window.addEventListener('touchmove', handleMove, {passive: false});
        window.addEventListener('touchend', handleEnd);

        // --- í•µì‹¬ ê¸°ëŠ¥ í•¨ìˆ˜ë“¤ ---

        function updateSelection() {
            document.querySelectorAll('.selecting').forEach(c => c.classList.remove('selecting'));
            const minT = Math.min(dragStart.time, dragEnd.time);
            const maxT = Math.max(dragStart.time, dragEnd.time);
            for (let t = minT; t <= maxT; t++) {
                const c = document.querySelector(`.schedule-cell[data-day="${dragStart.day}"][data-time="${t}"]`);
                if (c) c.classList.add('selecting');
            }
        }

        function renderEvents() {
            document.querySelectorAll('.event').forEach(e => e.remove());
            events.forEach((event, index) => {
                const eventEl = document.createElement('div');
                eventEl.className = `event ${event.user || 'ahyun'}`;
                const duration = event.endTime - event.startTime + 1;
                eventEl.style.height = `${duration * 45 - 2}px`;
                eventEl.style.top = '1px';
                
                const userIcon = event.user === 'ahyun' ? 'ğŸ‘©' : event.user === 'haseung' ? 'ğŸ‘¨' : 'ğŸ‘¥';
                eventEl.innerHTML = `
                    <div class="event-title">${userIcon} ${event.title}</div>
                    <div class="event-time">${times[event.startTime]}</div>
                    <button class="event-edit" onclick="event.stopPropagation(); editEvent(${index})">âœï¸</button>
                    <button class="event-delete" onclick="event.stopPropagation(); deleteEvent(${index})">Ã—</button>
                    <div class="event-resize-handle"></div>
                `;

                // ì´ë™ ë“œë˜ê·¸ ì‹œì‘ (ëª¨ë°”ì¼ ëŒ€ì‘)
                const startDragEvent = (e) => {
                    if(e.target.classList.contains('event-resize-handle')) {
                        isResizing = true; resizingEvent = index;
                    } else {
                        if (e.ctrlKey || e.metaKey) {
                            copiedEvent = { ...event };
                            showNotification('ë³µì‚¬ë¨');
                        } else {
                            isDraggingEvent = true; draggedEventIndex = index;
                        }
                    }
                    e.stopPropagation();
                };
                eventEl.addEventListener('mousedown', startDragEvent);
                eventEl.addEventListener('touchstart', startDragEvent);

                const cell = document.querySelector(`.schedule-cell[data-day="${event.day}"][data-time="${event.startTime}"]`);
                if (cell) cell.appendChild(eventEl);
            });
        }

        // --- ê¸°íƒ€ UI ì œì–´ í•¨ìˆ˜ë“¤ (ê¸°ì¡´ ë¡œì§ ìœ ì§€) ---
        function openModal(start, end) {
            const minT = Math.min(start.time, end.time), maxT = Math.max(start.time, end.time);
            currentEvent = { day: start.day, startTime: minT, endTime: maxT, user: selectedUser };
            document.getElementById('eventTitle').value = '';
            document.getElementById('eventDescription').value = '';
            document.getElementById('eventModal').classList.add('active');
        }
        function closeModal() { document.getElementById('eventModal').classList.remove('active'); }
        function saveEvent() {
            const title = document.getElementById('eventTitle').value.trim();
            if (!title) return alert('ì œëª© ì…ë ¥!');
            const desc = document.getElementById('eventDescription').value;
            if (currentEvent.index !== undefined) {
                events[currentEvent.index] = { ...events[currentEvent.index], title, description: desc, user: selectedUser };
            } else {
                events.push({ ...currentEvent, title, description: desc, user: selectedUser });
            }
            saveToLocalStorage(); renderEvents(); closeModal();
        }
        function editEvent(index) {
            const ev = events[index];
            currentEvent = { ...ev, index };
            selectUser(ev.user || 'ahyun');
            document.getElementById('eventTitle').value = ev.title;
            document.getElementById('eventDescription').value = ev.description || '';
            document.getElementById('eventModal').classList.add('active');
        }
        function deleteEvent(index) { if(confirm('ì‚­ì œí• ê¹Œìš”?')) { events.splice(index,1); saveToLocalStorage(); renderEvents(); } }
        function selectUser(u) {
            selectedUser = u;
            document.querySelectorAll('.user-selector .user-button').forEach(b => b.classList.toggle('active', b.classList.contains(u)));
        }
        function saveToLocalStorage() { localStorage.setItem('weeklyEvents', JSON.stringify(events)); }
        function clearAllEvents() { if(confirm('ì „ì²´ ì‚­ì œ?')) { events = []; saveToLocalStorage(); renderEvents(); } }

        // ë‚ ì§œ ê´€ë¦¬
        function openDateModal() { document.getElementById('dateModal').classList.add('active'); }
        function closeDateModal() { document.getElementById('dateModal').classList.remove('active'); }
        function saveDates() {
            const d = document.getElementById('mondayDate').value;
            if(!d) return alert('ë‚ ì§œ ì„ íƒ!');
            weekDates = { monday: d };
            localStorage.setItem('weekDates', JSON.stringify(weekDates));
            applyDates(); closeDateModal();
        }
        function applyDates() {
            if(!weekDates) return;
            const mon = new Date(weekDates.monday);
            for(let i=0; i<7; i++) {
                const cur = new Date(mon); cur.setDate(mon.getDate() + i);
                document.getElementById(`date-${i}`).textContent = `(${cur.getMonth()+1}/${cur.getDate()})`;
            }
        }

        // ì¸ì‡„ ë° ë‚´ë³´ë‚´ê¸° (ê¸°ì¡´ ê¸°ëŠ¥ ê·¸ëŒ€ë¡œ ì´ì‹)
        function openPrintModal() {
            const s = document.getElementById('printStartTime'), e = document.getElementById('printEndTime');
            s.innerHTML = ''; e.innerHTML = '';
            times.forEach((t, i) => {
                s.add(new Option(t, i)); e.add(new Option(t, i));
            });
            e.value = times.length - 1;
            document.getElementById('printModal').classList.add('active');
        }
        function closePrintModal() { document.getElementById('printModal').classList.remove('active'); }
        function selectOrientation(o) {
            selectedOrientation = o;
            document.getElementById('p-portrait').classList.toggle('active', o==='portrait');
            document.getElementById('p-landscape').classList.toggle('active', o==='landscape');
        }
        async function executePrint() {
            const start = parseInt(document.getElementById('printStartTime').value);
            const end = parseInt(document.getElementById('printEndTime').value);
            closePrintModal();
            document.getElementById('loadingOverlay').classList.add('active');
            
            const allRows = document.querySelectorAll('[data-row]');
            allRows.forEach(row => {
                const idx = parseInt(row.dataset.row);
                row.style.display = (idx < start || idx > end) ? 'none' : '';
            });

            setTimeout(async () => {
                const canvas = await html2canvas(grid, { scale: 2 });
                allRows.forEach(row => row.style.display = '');
                const img = new Image(); img.src = canvas.toDataURL();
                img.style.width = '100%';
                const pc = document.getElementById('printContainer');
                pc.innerHTML = ''; pc.appendChild(img);
                
                const style = document.createElement('style');
                style.textContent = `@media print { @page { size: A4 ${selectedOrientation}; margin: 5mm; } }`;
                document.head.appendChild(style);
                
                document.getElementById('loadingOverlay').classList.remove('active');
                window.print();
            }, 500);
        }

        function exportSchedule() {
            const data = JSON.stringify({ events, weekDates });
            const blob = new Blob([data], {type: 'application/json'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a'); a.href = url; a.download = 'schedule.json'; a.click();
        }
        function importSchedule() {
            const input = document.createElement('input'); input.type = 'file';
            input.onchange = e => {
                const reader = new FileReader();
                reader.onload = ev => {
                    const d = JSON.parse(ev.target.result);
                    events = d.events || []; weekDates = d.weekDates || null;
                    saveToLocalStorage(); if(weekDates) localStorage.setItem('weekDates', JSON.stringify(weekDates));
                    applyDates(); renderEvents();
                };
                reader.readAsText(e.target.files[0]);
            };
            input.click();
        }
        function showNotification(m) {
            const n = document.createElement('div');
            n.textContent = m; n.style.cssText = "position:fixed; top:20px; left:50%; transform:translateX(-50%); background:rgba(0,0,0,0.7); color:white; padding:8px 16px; border-radius:20px; z-index:9999; font-size:12px;";
            document.body.appendChild(n);
            setTimeout(() => n.remove(), 2000);
        }

        // ì´ˆê¸° ì‹¤í–‰
        applyDates(); renderEvents();
    </script>
</body>
</html>
